<html>
 <head>
  <style id="code-style">
#ui-editor-outer-div .t1 .kwd{color:#6679cc}
#ui-editor-outer-div .t1 .com{color:#6b7394}
#ui-editor-outer-div .t1 .str{color:#ac9739}
#ui-editor-outer-div .t1 .atv{color:#22a2c9}
#ui-editor-outer-div .t1 .typ,#ui-editor-outer-div .t1 .fun{color:#3d8fd1}
#ui-editor-outer-div .t1 .tag,#ui-editor-outer-div .t1 .var{color:#c94922}
#ui-editor-outer-div .t1 .lit,#ui-editor-outer-div .t1 .atn,#ui-editor-outer-div .t1 .dec{color:#c76b29}
#ui-editor-outer-div .t1 .pln,#ui-editor-outer-div .t1 .pun,#ui-editor-outer-div .t1 .opn,#ui-editor-outer-div .t1 .clo{color:#f5f7ff}
#ui-editor-outer-div .t2 .kwd{color:#a71d5d}
#ui-editor-outer-div .t2 .com{color:#969896}
#ui-editor-outer-div .t2 .str{color:#183691}
#ui-editor-outer-div .t2 .atv{color:#183691}
#ui-editor-outer-div .t2 .typ{color:#0086b3}
#ui-editor-outer-div .t2 .fun{color:#900}
#ui-editor-outer-div .t2 .tag{color:navy}
#ui-editor-outer-div .t2 .var{color:teal}
#ui-editor-outer-div .t2 .lit{color:#0086b3}
#ui-editor-outer-div .t2 .atn{color:#795da3}
#ui-editor-outer-div .t2 .pln,#editorpane .t2 .pun,#ui-editor-outer-div .t2 .opn,#ui-editor-outer-div .t2 .clo,#ui-editor-outer-div .t2 .dec{color:#333}
</style>
  <style id="publish-layout" type="text/css">.linepath { fill-opacity: 0; }</style>
  <link rel="stylesheet" href="../../styles/export-manual-iframe.css">
 </head>
 <body>
  <h1>CSV Parser</h1>
  <div class="zw-page" doc-id="page_032258545056322885">
   <div class="zw-header" doc-id="header_028549261034054707" node-id="default_header" style="-aw-headerfooter-type: header-primary;">
    <p doc-id="para_031804789371814635" node-id="node_06131617015524762" style="margin: 0px; line-height: 1.2; text-align: left; padding-bottom: 0px; padding-top: 0px;"><br></p>
    <div></div>
   </div>
   <div class="selectableSection zw-contentpane" doc-id="content_09842286398114017" node-id="content_1">
    <p doc-id="para_08911676632685865" node-id="node_08511504458842285" style="margin: 0px; line-height: 1.2; text-align: left; direction: ltr; padding-bottom: 0px; padding-top: 0px; border-bottom: 0px;"><span style="margin-left: 0in; border-width: 0px; border-style: none; border-color: rgb(0, 0, 0); padding: 0px; border-radius: 0px; width: 800px; height: 520px; display: inline-block;" class=" zls-image-wrapper"><img data-fmt="{&quot;op&quot;:100,&quot;wid_un&quot;:&quot;px&quot;,&quot;ht_un&quot;:&quot;px&quot;,&quot;borders&quot;:{&quot;border-top&quot;:{&quot;color&quot;:&quot;rgb(0,0,0)&quot;,&quot;width&quot;:&quot;0px&quot;,&quot;type&quot;:&quot;none&quot;,&quot;space&quot;:&quot;0px&quot;},&quot;border-radius&quot;:{&quot;br-topRight&quot;:0,&quot;br-bottomLeft&quot;:0,&quot;br-bottomRight&quot;:0,&quot;br-topLeft&quot;:0},&quot;border-right&quot;:{&quot;color&quot;:&quot;rgb(0,0,0)&quot;,&quot;width&quot;:&quot;0px&quot;,&quot;type&quot;:&quot;none&quot;,&quot;space&quot;:&quot;0px&quot;},&quot;border-left&quot;:{&quot;color&quot;:&quot;rgb(0,0,0)&quot;,&quot;width&quot;:&quot;0px&quot;,&quot;type&quot;:&quot;none&quot;,&quot;space&quot;:&quot;0px&quot;},&quot;border-bottom&quot;:{&quot;color&quot;:&quot;rgb(0,0,0)&quot;,&quot;width&quot;:&quot;0px&quot;,&quot;type&quot;:&quot;none&quot;,&quot;space&quot;:&quot;0px&quot;}},&quot;mr&quot;:&quot;0.000in&quot;,&quot;mt&quot;:&quot;0.000in&quot;,&quot;orginalWid&quot;:800,&quot;type&quot;:&quot;image&quot;,&quot;ht&quot;:520,&quot;wid&quot;:800,&quot;top&quot;:0,&quot;left&quot;:0,&quot;mb&quot;:&quot;0.000in&quot;,&quot;id&quot;:47445954,&quot;orginalHt&quot;:520,&quot;ml&quot;:&quot;0.000in&quot;}" height="520" src="../../inline-images/payout-parser/csv-parser/1684517306952.png" style="width: 800px; height: 520px; opacity: 1;" width="800"></span></p>
    <h3 doc-id="para_017372632434134072" node-id="node_02054877426004431" style="line-height: 1.2; text-align: left; margin-bottom: 0px; background-color: rgb(255, 255, 255); margin-left: 0px; padding-bottom: 0px; margin-top: 0px; border-top: 0px; padding-top: 0px; border-bottom: 0px;"><span style="font-family: Roboto; color: rgb(0, 0, 0); font-size: 16pt; font-weight: 700; text-decoration: underline; vertical-align: baseline; background-color: rgb(255, 255, 255);">Overview</span><span data-bookmark-id="toc_yp1z2mjzfpbp" data-bookmark-name="_Tockx0l6fnu9jee" id="_Tockx0l6fnu9jee"></span></h3>
    <p doc-id="para_027690411391069847" node-id="node_008037874013671265" style="margin: 0px; line-height: 1.2; text-align: left; direction: ltr; padding-bottom: 0px; border-top: 0px; padding-top: 0px; border-bottom: 0px;"><span style="font-family: Roboto; color: rgb(37, 37, 37); font-size: 12pt; vertical-align: baseline; font-weight: 400;">This application allows the user to drop a payout CSV file and submit it for parsing. Firstly, it uses a library called PapaParse that parses the CSV and turns the data into an array. It then loops through each row in the array and finds the matching Account ID and Contact ID using the searchRecords API in the Zoho SDK. The Account ID is pulled from the Accounts module and is searched by the name given in the data. The Contact ID is pulled from the Contacts module and is searched by the AC Account Number. If the record does not have an account ID or contact ID, then these fields will be left empty. After this, the data is put into a request body and uploaded to the AC CRM. The insertRecords API is used and specifies that the records are uploaded in the Payouts module. The file is then attached to the record.</span></p>
    <p doc-id="para_07088707134499053" node-id="node_05329115242995117" style="margin: 0px; line-height: 1.2; text-align: left; direction: ltr; padding-bottom: 0px; border-top: 0px; padding-top: 0px; border-bottom: 0px;"><br></p>
    <p doc-id="para_07053667593448725" node-id="node_08800957303567123" style="margin: 0px; line-height: 1.2; text-align: left; direction: ltr; padding-bottom: 0px; border-top: 0px; padding-top: 0px;"><span style="font-family: Roboto; color: rgb(0, 0, 0); font-size: 16pt; text-decoration: underline; font-weight: 700; vertical-align: baseline; background-color: rgb(255, 255, 255);">Step by step</span></p>
    <ol class="lst-76907003--1" data-list="listId:76907003,listLevel:0" start="1" style="list-style: decimal; font-style: normal; font-variant: normal; text-decoration: none; font-size: 12pt; font-family: Roboto; letter-spacing: 0pt; color: rgb(0, 0, 0); padding: 0px; margin: 0px; border-bottom: 0px;">
     <li doc-id="para_08417461118475378" node-id="node_0254770852316359" style="line-height: 1.2; text-align: left; margin-bottom: 0px; direction: ltr; margin-left: 37.2031px; font-size: 10.5pt; padding-bottom: 0px; margin-top: 0px; padding-top: 0px; padding-left: 10.7969px;"><span style="font-family: Roboto; color: rgb(0, 0, 0); font-size: 12pt; vertical-align: baseline; font-weight: 400; background-color: rgb(255, 255, 255); padding-left: 0px;">The user will drop a Payout file, select the insurance carrier and payout type, and hit submit file.</span></li>
     <li doc-id="para_040621521064735244" node-id="node_034517274952620114" style="line-height: 1.2; text-align: left; margin-bottom: 0px; direction: ltr; margin-left: 37.2031px; font-size: 10.5pt; padding-bottom: 0px; margin-top: 0px; border-top: 0px; padding-top: 0px; padding-left: 10.7969px; border-bottom: 0px;"><span style="font-family: Roboto; color: rgb(0, 0, 0); font-size: 12pt; vertical-align: baseline; font-weight: 400; background-color: rgb(255, 255, 255); padding-left: 0px;">PapaParse reads the file and turns it into an array. It then removes the extra spaces from the object keys and values.</span></li>
     <li doc-id="para_05428927336631175" node-id="node_0011337381598079732" style="line-height: 1.2; text-align: left; margin-bottom: 0px; direction: ltr; margin-left: 37.2031px; font-size: 10.5pt; padding-bottom: 0px; margin-top: 0px; border-top: 0px; padding-top: 0px; padding-left: 10.7969px; border-bottom: 0px;"><span style="font-family: Roboto; color: rgb(0, 0, 0); font-size: 12pt; vertical-align: baseline; font-weight: 400; background-color: rgb(255, 255, 255); padding-left: 0px;">The loop begins and the modal pops up showing the who we are uploading the payout for.</span></li>
     <li doc-id="para_05373648659639325" node-id="node_036262495084412505" style="line-height: 1.2; text-align: left; margin-bottom: 0px; direction: ltr; margin-left: 37.2031px; font-size: 10.5pt; padding-bottom: 0px; margin-top: 0px; border-top: 0px; padding-top: 0px; padding-left: 10.7969px; border-bottom: 0px;"><span style="font-family: Roboto; color: rgb(0, 0, 0); font-size: 12pt; vertical-align: baseline; font-weight: 400; background-color: rgb(255, 255, 255); padding-left: 0px;">Each loop will grab and upload the data to Zoho from the current row it is iterating on.</span></li>
     <li doc-id="para_07613339684389604" node-id="node_09697706373710586" style="line-height: 1.2; text-align: left; margin-bottom: 0px; direction: ltr; margin-left: 37.2031px; font-size: 10.5pt; padding-bottom: 0px; margin-top: 0px; border-top: 0px; padding-top: 0px; padding-left: 10.7969px; border-bottom: 0px;"><span style="font-family: Roboto; color: rgb(0, 0, 0); font-size: 12pt; vertical-align: baseline; font-weight: 400; background-color: rgb(255, 255, 255); padding-left: 0px;">Only on the first iteration of the parser, we use a searchRecord function to see if there is a Total Payout Report that starts with the same name.&nbsp;</span><span style="font-family: Roboto; color: rgb(0, 0, 0); font-size: 12pt; vertical-align: baseline; font-weight: 400; background-color: rgb(255, 255, 255);">If there is a Total Payout Report with the same name, then every Total Payout Report that starts with the same name will end with an integer that is based on the order it was uploaded. If not, then the Total Payout Report's name will not end with an integer.</span></li>
     <li doc-id="para_09256378981833642" node-id="node_09992342901014428" style="line-height: 1.2; text-align: left; margin-bottom: 0px; direction: ltr; margin-left: 37.2031px; font-size: 10.5pt; padding-bottom: 0px; margin-top: 0px; border-top: 0px; padding-top: 0px; padding-left: 10.7969px; border-bottom: 0px;"><span style="font-family: Roboto; color: rgb(0, 0, 0); font-size: 12pt; vertical-align: baseline; font-weight: 400; background-color: rgb(255, 255, 255); padding-left: 0px;">After the Total Payout Report is created, two searchRecords are performed for every iteration. It finds the contact and an account to create a relationship between the two modules and Payout Report. If there is not an account or contact relating to the report then the field is left empty.</span></li>
     <li doc-id="para_05786340457065282" node-id="node_09285883530171488" style="line-height: 1.2; text-align: left; margin-bottom: 0px; direction: ltr; margin-left: 37.2031px; font-size: 10.5pt; padding-bottom: 0px; margin-top: 0px; border-top: 0px; padding-top: 0px; padding-left: 10.7969px; border-bottom: 0px;"><span style="font-family: Roboto; color: rgb(0, 0, 0); font-size: 12pt; vertical-align: baseline; font-weight: 400; background-color: rgb(255, 255, 255); padding-left: 0px;">The report is uploaded.</span></li>
     <li doc-id="para_07789530844992718" node-id="node_09133641159956116" style="line-height: 1.2; text-align: left; margin-bottom: 0px; direction: ltr; margin-left: 37.2031px; font-size: 10.5pt; padding-bottom: 0px; margin-top: 0px; border-top: 0px; padding-top: 0px; padding-left: 10.7969px;"><span style="font-family: Roboto; color: rgb(0, 0, 0); font-size: 12pt; vertical-align: baseline; font-weight: 400; background-color: rgb(255, 255, 255); padding-left: 0px;">The file is attached to the Total Payout Report by using the returned record id.</span></li>
    </ol>
    <div></div>
    <p doc-id="para_006458325273074128" node-id="node_035578718298842027" style="margin: 0px; line-height: 1.2; text-align: left; direction: ltr; padding-bottom: 0px; padding-top: 0px; border-bottom: 0px;"><br></p>
    <h3 doc-id="para_05160672033384688" node-id="node_08407599978615503" style="line-height: 1.2; text-align: left; margin-bottom: 10.6667px; background-color: rgb(255, 255, 255); margin-left: 0px; padding-bottom: 0px; margin-top: 0px; border-top: 0px; padding-top: 0px;"><span style="font-family: Roboto; color: rgb(0, 0, 0); font-size: 16pt; font-weight: 700; text-decoration: underline; vertical-align: baseline; background-color: rgb(255, 255, 255);">Dependencies</span><span data-bookmark-id="toc_5rdn12cd0g49" data-bookmark-name="_Tociz19fq1b3o34" id="_Tociz19fq1b3o34"></span></h3>
    <ul class="lst-91745866--1" data-list="listId:91745866,listLevel:0" style="list-style: disc; font-size: 12pt; font-family: Roboto; letter-spacing: 0px; color: rgb(0, 0, 0); padding: 0px; margin: 0px; border-bottom: 0px;">
     <li doc-id="para_044487552893569404" node-id="node_0908731464036008" style="line-height: 1.2; text-align: left; margin-bottom: 0px; direction: ltr; margin-left: 33.6719px; font-size: 12pt; padding-bottom: 0px; margin-top: 0px; padding-top: 0px; padding-left: 14.3281px;"><span style="font-family: Roboto; color: rgb(0, 0, 0); font-size: 12pt; vertical-align: baseline; font-weight: 400; background-color: rgb(255, 255, 255); padding-left: 0px;">JQuery</span></li>
     <li doc-id="para_03316057253267919" node-id="node_09652764941258221" style="line-height: 1.2; text-align: left; margin-bottom: 0px; direction: ltr; margin-left: 33.6719px; font-size: 12pt; padding-bottom: 0px; margin-top: 0px; border-top: 0px; padding-top: 0px; padding-left: 14.3281px;"><span style="font-family: Roboto; color: rgb(0, 0, 0); font-size: 12pt; vertical-align: baseline; font-weight: 400; background-color: rgb(255, 255, 255); padding-left: 0px;">Zoho Embedded App SDK</span></li>
    </ul>
   </div>
   <div class="zw-footer" doc-id="footer_0897657480004485" node-id="default_footer" style="-aw-headerfooter-type: footer-primary;">
    <p doc-id="para_07482497920772309" node-id="node_030362792176135023" style="margin: 0px; line-height: 1.2; text-align: left; padding-bottom: 0px; padding-top: 0px;"><br></p>
    <div></div>
   </div>
  </div>
  <div id="htmlprocess-completed" style="display: none !important; top: -10000px; left: -100000px; visibility: hidden;"></div>
  <style id="webfonts-style" type="text/css">@font-face{font-family:'Roboto';font-weight:100;font-style:normal;src:url('https://static.zohocdn.com/webfonts/robotothin/font.woff2') format('woff2'),url('https://static.zohocdn.com/webfonts/robotothin/font.woff') format('woff');}@font-face{font-family:'Roboto';font-weight:300;font-style:normal;src:url('https://static.zohocdn.com/webfonts/robotolight/font.woff2') format('woff2'),url('https://static.zohocdn.com/webfonts/robotolight/font.woff') format('woff');}@font-face{font-family:'Roboto';font-weight:400;font-style:normal;src:url('https://static.zohocdn.com/webfonts/robotoregular/font.woff2') format('woff2'),url('https://static.zohocdn.com/webfonts/robotoregular/font.woff') format('woff');}@font-face{font-family:'Roboto';font-weight:500;font-style:normal;src:url('https://static.zohocdn.com/webfonts/robotomedium/font.woff2') format('woff2'),url('https://static.zohocdn.com/webfonts/robotomedium/font.woff') format('woff');}@font-face{font-family:'Roboto';font-weight:700;font-style:normal;src:url('https://static.zohocdn.com/webfonts/robotobold/font.woff2') format('woff2'),url('https://static.zohocdn.com/webfonts/robotobold/font.woff') format('woff');}@font-face{font-family:'Roboto';font-weight:900;font-style:normal;src:url('https://static.zohocdn.com/webfonts/robotoblack/font.woff2') format('woff2'),url('https://static.zohocdn.com/webfonts/robotoblack/font.woff') format('woff');}@font-face{font-family:'Roboto';font-weight:100;font-style:italic;src:url('https://static.zohocdn.com/webfonts/robotothinitalic/font.woff2') format('woff2'),url('https://static.zohocdn.com/webfonts/robotothinitalic/font.woff') format('woff');}@font-face{font-family:'Roboto';font-weight:300;font-style:italic;src:url('https://static.zohocdn.com/webfonts/robotolightitalic/font.woff2') format('woff2'),url('https://static.zohocdn.com/webfonts/robotolightitalic/font.woff') format('woff');}@font-face{font-family:'Roboto';font-weight:400;font-style:italic;src:url('https://static.zohocdn.com/webfonts/robotoitalic/font.woff2') format('woff2'),url('https://static.zohocdn.com/webfonts/robotoitalic/font.woff') format('woff');}@font-face{font-family:'Roboto';font-weight:500;font-style:italic;src:url('https://static.zohocdn.com/webfonts/robotomediumitalic/font.woff2') format('woff2'),url('https://static.zohocdn.com/webfonts/robotomediumitalic/font.woff') format('woff');}@font-face{font-family:'Roboto';font-weight:700;font-style:italic;src:url('https://static.zohocdn.com/webfonts/robotobolditalic/font.woff2') format('woff2'),url('https://static.zohocdn.com/webfonts/robotobolditalic/font.woff') format('woff');}@font-face{font-family:'Roboto';font-weight:900;font-style:italic;src:url('https://static.zohocdn.com/webfonts/robotoblackitalic/font.woff2') format('woff2'),url('https://static.zohocdn.com/webfonts/robotoblackitalic/font.woff') format('woff');}</style>
  <div>
   <ul id="appendAttachment" class="zl-article-attachment"></ul>
  </div>
 </body>
</html>